{
  "paragraphs": [
    {
      "text": "%md\n## Apache Spark - DataFrame/DataSet API - základní syntax a práce s daty\n\n### Spark 2.3.4\n* DataFrame: https://spark.apache.org/docs/2.3.4/sql-programming-guide.html\n* RDD:\n    * https://spark.apache.org/docs/2.3.4/rdd-programming-guide.html\n    * příklady: https://wikis.nyu.edu/display/NYUHPC/Big+Data+Tutorial+3%3A+Introduction+to+Spark\n\n### Scala\n* guide: https://www.analyticsvidhya.com/blog/2017/01/scala/\n\n### datové zdroje:\n* http://opendata.praha.eu/\n   * chytry svoz odpadu - historie zaplnitelnosti: http://opendata.praha.eu/dataset/chytry-svoz-odpadu-historicka-data-zaplnenosti\n   * chytry svoz odpadu  - svozy kontejnerů na tříděný odpad: http://opendata.praha.eu/dataset/chytry-svoz-odpadu-svozy-kontejneru-na-trideny-odpad\n   \n### hodí se\n* `df.printSchema()` - vypíše názvy a typy sloupců\n* `df.show(X)`- zobrazí X počet řádků z datasetu, nezáleží na pořadí, nevyvolává action trigger\n* `df.show(false)`- nezkracuje data v zobrazených sloupcích\n\n|| Zeppelin creates and injects sc (SparkContext) and sqlContext (HiveContext or SqlContext)",
      "user": "anonymous",
      "dateUpdated": "2019-10-29 12:18:44.611",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eApache Spark - DataFrame/DataSet API - základní syntax a práce s daty\u003c/h2\u003e\n\u003ch3\u003eSpark 2.3.4\u003c/h3\u003e\n\u003cul\u003e\n  \u003cli\u003eDataFrame: \u003ca href\u003d\"https://spark.apache.org/docs/2.3.4/sql-programming-guide.html\"\u003ehttps://spark.apache.org/docs/2.3.4/sql-programming-guide.html\u003c/a\u003e\u003c/li\u003e\n  \u003cli\u003eRDD:\n    \u003cul\u003e\n      \u003cli\u003e\u003ca href\u003d\"https://spark.apache.org/docs/2.3.4/rdd-programming-guide.html\"\u003ehttps://spark.apache.org/docs/2.3.4/rdd-programming-guide.html\u003c/a\u003e\u003c/li\u003e\n      \u003cli\u003epříklady: \u003ca href\u003d\"https://wikis.nyu.edu/display/NYUHPC/Big+Data+Tutorial+3%3A+Introduction+to+Spark\"\u003ehttps://wikis.nyu.edu/display/NYUHPC/Big+Data+Tutorial+3%3A+Introduction+to+Spark\u003c/a\u003e\u003c/li\u003e\n    \u003c/ul\u003e\n  \u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eScala\u003c/h3\u003e\n\u003cul\u003e\n  \u003cli\u003eguide: \u003ca href\u003d\"https://www.analyticsvidhya.com/blog/2017/01/scala/\"\u003ehttps://www.analyticsvidhya.com/blog/2017/01/scala/\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003edatové zdroje:\u003c/h3\u003e\n\u003cul\u003e\n  \u003cli\u003e\u003ca href\u003d\"http://opendata.praha.eu/\"\u003ehttp://opendata.praha.eu/\u003c/a\u003e\u003c/li\u003e\n  \u003cli\u003echytry svoz odpadu - historie zaplnitelnosti: \u003ca href\u003d\"http://opendata.praha.eu/dataset/chytry-svoz-odpadu-historicka-data-zaplnenosti\"\u003ehttp://opendata.praha.eu/dataset/chytry-svoz-odpadu-historicka-data-zaplnenosti\u003c/a\u003e\u003c/li\u003e\n  \u003cli\u003echytry svoz odpadu - svozy kontejnerů na tříděný odpad: \u003ca href\u003d\"http://opendata.praha.eu/dataset/chytry-svoz-odpadu-svozy-kontejneru-na-trideny-odpad\"\u003ehttp://opendata.praha.eu/dataset/chytry-svoz-odpadu-svozy-kontejneru-na-trideny-odpad\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003ehodí se\u003c/h3\u003e\n\u003cul\u003e\n  \u003cli\u003e\u003ccode\u003edf.printSchema()\u003c/code\u003e - vypíše názvy a typy sloupců\u003c/li\u003e\n  \u003cli\u003e\u003ccode\u003edf.show(X)\u003c/code\u003e- zobrazí X počet řádků z datasetu, nezáleží na pořadí, nevyvolává action trigger\u003c/li\u003e\n  \u003cli\u003e\u003ccode\u003edf.show(false)\u003c/code\u003e- nezkracuje data v zobrazených sloupcích\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e|| Zeppelin creates and injects sc (SparkContext) and sqlContext (HiveContext or SqlContext)\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1572275721494_-1214949586",
      "id": "20191028-093724_2122815264",
      "dateCreated": "2019-10-28 15:15:21.494",
      "dateStarted": "2019-10-29 12:18:44.631",
      "dateFinished": "2019-10-29 12:18:44.688",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## READ\n* **read** (csv, parquet, avro, textfile, ...)\n* **toDF** (RDD parralelize)\n* IOUtils",
      "user": "anonymous",
      "dateUpdated": "2019-10-29 12:15:00.153",
      "config": {
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eREAD\u003c/h2\u003e\n\u003cul\u003e\n  \u003cli\u003e\u003cem\u003eread\u003c/em\u003e (csv, parquet, avro, textfile, \u0026hellip;)\u003c/li\u003e\n  \u003cli\u003e\u003cem\u003etoDF\u003c/em\u003e (RDD parralelize)\u003c/li\u003e\n  \u003cli\u003ejdbc\u003c/li\u003e\n  \u003cli\u003eIOUtils\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1572275721499_1700764172",
      "id": "20191028-114904_943505836",
      "dateCreated": "2019-10-28 15:15:21.499",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// načtení dataframe \n\n// z kolekce\n\n// ze souboru\n\n// z url (když zbude čas)",
      "user": "anonymous",
      "dateUpdated": "2019-10-29 12:22:23.717",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1572275721499_-16819059",
      "id": "20191028-115012_113346922",
      "dateCreated": "2019-10-28 15:15:21.499",
      "dateStarted": "2019-10-29 12:19:00.033",
      "dateFinished": "2019-10-29 12:19:18.926",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## NARROW transformace\n\nTransformace, které nevyvolávají shuffle (přenos dat po síti), lazy evaulation.\n\n* select\n* withColumn\n* distinct\n* drop\n* filter\n* union",
      "user": "anonymous",
      "dateUpdated": "2019-10-29 12:23:26.287",
      "config": {
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eNARROW transformace\u003c/h2\u003e\n\u003cp\u003eTransformace,které nevyvolávají shuffle (přenos dat po síti), lazy evaulation.\u003c/p\u003e\n\u003cul\u003e\n  \u003cli\u003eselect\u003c/li\u003e\n  \u003cli\u003ewithColumn\u003c/li\u003e\n  \u003cli\u003edistinct\u003c/li\u003e\n  \u003cli\u003edrop\u003c/li\u003e\n  \u003cli\u003efilter\u003c/li\u003e\n  \u003cli\u003eunion\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1572275721499_984472126",
      "id": "20191028-111633_1032845225",
      "dateCreated": "2019-10-28 15:15:21.499",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// distinct: jaké můžou být minfilllevely?\n\n// withColumn - přidá sloupec, (jméno sloupce, transformační funkce)\n\n// select: projekce\n\n// select: projekce + transformace\n\n// filter: ktere kontejnery byly vyneseny skoro nebo zcela plne\n",
      "user": "anonymous",
      "dateUpdated": "2019-10-29 12:28:38.277",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1572275721500_-820733526",
      "id": "20191028-115108_2018975206",
      "dateCreated": "2019-10-28 15:15:21.500",
      "dateStarted": "2019-10-29 12:28:38.352",
      "dateFinished": "2019-10-29 12:28:38.829",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// EXPLODE vs SPLIT\n// explode\n\n// split\n",
      "user": "anonymous",
      "dateUpdated": "2019-10-29 12:32:37.777",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------------------+\n|             value|\n+------------------+\n| [jedna, dva, tri]|\n|[ctyri, pet, sest]|\n+------------------+\n\n+------------------+--------+\n|             value|exploded|\n+------------------+--------+\n| [jedna, dva, tri]|   jedna|\n| [jedna, dva, tri]|     dva|\n| [jedna, dva, tri]|     tri|\n|[ctyri, pet, sest]|   ctyri|\n|[ctyri, pet, sest]|     pet|\n|[ctyri, pet, sest]|    sest|\n+------------------+--------+\n\n+-------------+\n|        value|\n+-------------+\n|jedna;dva;tri|\n+-------------+\n\n+-----+----+----+\n| col1|col2|col3|\n+-----+----+----+\n|jedna| dva| tri|\n+-----+----+----+\n\ndf_exp1: org.apache.spark.sql.DataFrame \u003d [value: array\u003cstring\u003e]\ndf_exp2: org.apache.spark.sql.DataFrame \u003d [value: array\u003cstring\u003e, exploded: string]\ndf_split1: org.apache.spark.sql.DataFrame \u003d [value: string]\ndf_split2: org.apache.spark.sql.DataFrame \u003d [col1: string, col2: string ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1572275721500_-101890263",
      "id": "20191028-125434_1254572877",
      "dateCreated": "2019-10-28 15:15:21.500",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// nacteni datasetu szn2018122019Q3\n\n// UNION\n\n// UNION 2",
      "user": "anonymous",
      "dateUpdated": "2019-10-29 12:52:14.803",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+------------+-----------------+--------+---------------+-------------------+--------------+-----------+------------+\n|     id|container_id|pick_minfilllevel|decrease|           code|        pick_at_utc|percent_before|percent_now|event_driven|\n+-------+------------+-----------------+--------+---------------+-------------------+--------------+-----------+------------+\n|5252000|       29806|               30|      20|0018/ 050C00471|2018-12-01 05:06:27|            76|          6|       false|\n|5278394|       29808|               30|      20|0018/ 050C00473|2018-12-03 09:08:48|            95|          2|       false|\n|5280954|       29789|               30|      20|0006/ 264C00204|2018-12-03 13:09:24|            89|         13|       false|\n+-------+------------+-----------------+--------+---------------+-------------------+--------------+-----------+------------+\nonly showing top 3 rows\n\nszn2018122019Q3: org.apache.spark.sql.DataFrame \u003d [id: int, container_id: int ... 7 more fields]\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1572275721502_-1847077772",
      "id": "20191028-095432_287439436",
      "dateCreated": "2019-10-28 15:15:21.502",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## AKCE\n* take\n* collect\n* save",
      "user": "anonymous",
      "dateUpdated": "2019-10-30 09:16:48.469",
      "config": {
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1572275721504_-497027006",
      "id": "20191028-111952_432182074",
      "dateCreated": "2019-10-28 15:15:21.504",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// N zaznamu -\u003e podmmnozina\n\n\n// N zaznamu -\u003e N zaznamu\n",
      "user": "anonymous",
      "dateUpdated": "2019-10-30 09:34:30.888",
      "config": {
        "tableHide": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "res40: Array[org.apache.spark.sql.Row] \u003d Array([15270292,30046,50,20,0003/ 014C00513,2019-10-01 05:00:41.0,100,1,false], [15270477,30327,30,20,0001/ 002C01582,2019-10-01 05:01:47.0,38,1,false])\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1572275721506_26105255",
      "id": "20191028-112010_1454345083",
      "dateCreated": "2019-10-28 15:15:21.506",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// save\n",
      "user": "anonymous",
      "dateUpdated": "2019-10-30 09:34:36.575",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1572428070960_-166589508",
      "id": "20191030-093430_928791391",
      "dateCreated": "2019-10-30 09:34:30.960",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// repartition, coalesce",
      "user": "anonymous",
      "dateUpdated": "2019-10-30 09:59:51.383",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1572429571959_764614059",
      "id": "20191030-095931_1072339765",
      "dateCreated": "2019-10-30 09:59:31.960",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## COUNT , distinct, aggregační fce\n  * count\n  * distinct\n  * min, max, avg\n  * sum, variance,...",
      "user": "anonymous",
      "dateUpdated": "2019-10-30 11:00:53.020",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1572426982384_1741029801",
      "id": "20191030-091622_1882214640",
      "dateCreated": "2019-10-30 09:16:22.389",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// informace o datsetu:\n\n// kolik mám zaznamu?\n// kolik unikátních odpadových kontejnerů máme\n// jaká je nevyšší/nejnižší zaplněnost\n// jaká je průměrná zaplněnost před a po (percent_before, percent_now)\n// jaké mám různé id konetjnerů\n// kolik je kontejnerů\n// co to je min fill level, jakých hodnot nabývají\n// jaké jsou různé kódové označení a kolik jich je\n// může být položka sloupce event_driven null?\n",
      "user": "anonymous",
      "dateUpdated": "2019-10-30 10:50:36.127",
      "config": {
        "tableHide": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "szn2019q4_count: Long \u003d 1002\nszn20182019q3_count: Long \u003d 22987\nszn_count: Long \u003d 23989\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1572275721507_787829764",
      "id": "20191028-103959_1146384647",
      "dateCreated": "2019-10-28 15:15:21.507",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## groupBy, groupBy + aggregace, join",
      "user": "anonymous",
      "dateUpdated": "2019-10-30 11:13:31.413",
      "config": {
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1572275721510_1132945627",
      "id": "20191028-114108_1299416038",
      "dateCreated": "2019-10-28 15:15:21.510",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// kolikrát byl který kontejner vysypán v únoru 2019?\n// kdy byl kontejner vysypán",
      "user": "anonymous",
      "dateUpdated": "2019-10-30 11:13:18.613",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true,
        "tableHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------------+-----+\n|container_id|count|\n+------------+-----+\n|       29894|   12|\n|       29993|    2|\n|       29950|   14|\n|       29827|   10|\n|       30330|   22|\n+------------+-----+\nonly showing top 5 rows\n\nvysypan: org.apache.spark.sql.DataFrame \u003d [container_id: int, pick_at_utc: timestamp]\nvysypan2: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] \u003d [container_id: int, pick_at_utc: timestamp]\nvysypan3: org.apache.spark.sql.DataFrame \u003d [container_id: int, count: bigint]\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1572275721510_955254940",
      "id": "20191028-110645_1932819943",
      "dateCreated": "2019-10-28 15:15:21.510",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "//groupby + aggregace\n\n// jaký je průmerný počet vysypání kontejnerů v jednotlivých letech\n// kolikrát byl který kontejner vysypán",
      "user": "anonymous",
      "dateUpdated": "2019-10-30 11:24:06.232",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true,
        "editorHide": false,
        "tableHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----+-----+------+\n|year|month|celkem|\n+----+-----+------+\n|2018|   12|   574|\n|2019|   01|  1686|\n|2019|   02|  2234|\n|2019|   03|  2599|\n|2019|   04|  2600|\n|2019|   05|  3033|\n|2019|   06|  2734|\n|2019|   07|  3193|\n|2019|   08|  2781|\n|2019|   09|  1553|\n|2019|   10|  1002|\n+----+-----+------+\n\n+----+----------------+---------------+\n|year|nejvice v mesici|nejmin v mesici|\n+----+----------------+---------------+\n|2018|             574|            574|\n|2019|            3193|           1002|\n+----+----------------+---------------+\n\nimport org.apache.spark.sql.functions\nagg1: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] \u003d [year: string, month: string ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1572275721518_794014260",
      "id": "20191028-123800_1146633843",
      "dateCreated": "2019-10-28 15:15:21.518",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "agg1.registerTempTable(\"rok_mesic_vyneseni\")",
      "user": "anonymous",
      "dateUpdated": "2019-10-28 15:15:21.519",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "warning: there was one deprecation warning; re-run with -deprecation for details\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1572275721519_-1698562749",
      "id": "20191028-132959_737440955",
      "dateCreated": "2019-10-28 15:15:21.519",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%sql\nselect * from rok_mesic_vyneseni",
      "user": "anonymous",
      "dateUpdated": "2019-10-30 11:50:20.671",
      "config": {
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/sql",
        "fontSize": 9.0,
        "results": {
          "0": {
            "graph": {
              "mode": "multiBarChart",
              "height": 300.0,
              "optionOpen": true,
              "setting": {
                "table": {
                  "tableGridState": {
                    "columns": [
                      {
                        "name": "year",
                        "visible": true,
                        "width": "*",
                        "sort": {},
                        "filters": [
                          {}
                        ],
                        "pinned": ""
                      },
                      {
                        "name": "month",
                        "visible": true,
                        "width": "*",
                        "sort": {},
                        "filters": [
                          {}
                        ],
                        "pinned": ""
                      },
                      {
                        "name": "celkem",
                        "visible": true,
                        "width": "*",
                        "sort": {},
                        "filters": [
                          {}
                        ],
                        "pinned": ""
                      }
                    ],
                    "scrollFocus": {},
                    "selection": [],
                    "grouping": {
                      "grouping": [],
                      "aggregations": [],
                      "rowExpandedStates": {}
                    },
                    "treeView": {},
                    "pagination": {
                      "paginationCurrentPage": 1.0,
                      "paginationPageSize": 250.0
                    }
                  },
                  "tableColumnTypeState": {
                    "names": {
                      "year": "string",
                      "month": "string",
                      "celkem": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": true
                  },
                  "updated": false,
                  "initialized": false
                },
                "multiBarChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                },
                "stackedAreaChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                },
                "lineChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                }
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "month",
                  "index": 1.0,
                  "aggr": "sum"
                },
                {
                  "name": "year",
                  "index": 0.0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "month",
                  "index": 1.0,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "year\tmonth\tcelkem\n2018\t12\t574\n2019\t01\t1686\n2019\t02\t2234\n2019\t03\t2599\n2019\t04\t2600\n2019\t05\t3033\n2019\t06\t2734\n2019\t07\t3193\n2019\t08\t2781\n2019\t09\t1553\n2019\t10\t1002\n"
          },
          {
            "type": "TEXT",
            "data": ""
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1572275721519_1808944850",
      "id": "20191028-132950_743763809",
      "dateCreated": "2019-10-28 15:15:21.519",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n### JOINY",
      "user": "anonymous",
      "dateUpdated": "2019-10-30 11:43:20.189",
      "config": {
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1572275721520_-2042501195",
      "id": "20191028-133352_2120525987",
      "dateCreated": "2019-10-28 15:15:21.520",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// inner\n// outer\n// full\n// full_outer\n// left\n// left_outer\n// right\n// right_outer\n// left_semi\n// left_anti",
      "user": "anonymous",
      "dateUpdated": "2019-10-30 11:44:00.936",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1572275721521_622374419",
      "id": "20191028-134712_683869744",
      "dateCreated": "2019-10-28 15:15:21.521",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n\u003d\u003d\u003d\u003d Chytrý odpad Prahy\ndata: http://opendata.praha.eu/dataset/chytry-svoz-odpadu-historicka-data-zaplnenosti",
      "user": "anonymous",
      "dateUpdated": "2019-10-30 11:52:12.523",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1572436294975_2104196465",
      "id": "20191030-115134_226116120",
      "dateCreated": "2019-10-30 11:51:34.975",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// načíst a spojit data",
      "user": "anonymous",
      "dateUpdated": "2019-10-30 11:59:02.198",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1572436727676_1821882806",
      "id": "20191030-115847_185262742",
      "dateCreated": "2019-10-30 11:58:47.677",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n### UDF\n\u003d User Defined Function\nv podstate ma Spark API \"jenom\" spoustu predpripravenych, pokud ale chceme nejakou specialni transformaci, tak musime napsat vlastni udf\n",
      "user": "anonymous",
      "dateUpdated": "2019-10-28 15:15:21.525",
      "config": {
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1572275721524_499474214",
      "id": "20191028-140217_133811049",
      "dateCreated": "2019-10-28 15:15:21.524",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// jak vypadá UDF, jak se píše\n\n\n// moje vlastní udf",
      "user": "anonymous",
      "dateUpdated": "2019-10-30 11:59:30.033",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1572436742282_-1588658461",
      "id": "20191030-115902_1039665396",
      "dateCreated": "2019-10-30 11:59:02.282",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// filter \u0026 select\nval nadoba30039 \u003d shjoin3.filter($\"container_id\" \u003d\u003d\u003d 30039).select(\"event_date\",\"container_id\",\"percent_calculated\",\"temperature\",\"battery_status\",\"measured_at_utc\",\"pick_at_utc\",\"percent_before\",\"percent_now\")\nnadoba30039.show(5)\n\n// moje vlastni udf\nimport org.apache.spark.sql.functions.udf\n\nval measured \u003d udf((eventDate: String, temperature: String) \u003d\u003e {\n    if(eventDate!\u003dnull) \"namerena teplota \" + temperature + \"°C\" else \"nemereno\"\n})\nval picked \u003d udf((eventDate: String, percentNow: String) \u003d\u003e {\n    if(eventDate!\u003dnull) \"vysypano pri zaplnenosti \" + percentNow + \"%\" else \"nevysypano\"\n})\nval bothEvents \u003d udf((picked: String, measured: String) \u003d\u003e {\n    if(picked!\u003dnull \u0026\u0026 measured!\u003dnull) true else false\n})\n\nval nadoba30039_2 \u003d nadoba30039.withColumn(\"info_m\", measured($\"measured_at_utc\",$\"temperature\")).withColumn(\"info_p\", picked($\"pick_at_utc\",$\"percent_before\")).withColumn(\"both_events\", bothEvents($\"pick_at_utc\",$\"measured_at_utc\"))\n\nval nadoba30039_3 \u003d nadoba30039_2.filter(\"both_events\").select(\"event_date\",\"info_m\",\"info_p\").sort(\"event_date\")\n\nnadoba30039_3.show(false)\n",
      "user": "anonymous",
      "dateUpdated": "2019-10-30 11:56:51.329",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1572436603871_-165917218",
      "id": "20191030-115643_1466344469",
      "dateCreated": "2019-10-30 11:56:43.871",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// zjistit informace o kontejneru 30039\n// viz zadani cviceni\n\n// 1) ke každé události přiřaďte název měsíce (leden, únor,...)\n// 2) k události měření teploty připište ok, not_ok podle toho jestli byla teplota pod/nad 10°C",
      "user": "anonymous",
      "dateUpdated": "2019-10-30 12:11:22.964",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----------+------------+------------------+-----------+--------------+-------------------+-----------+--------------+-----------+\n|event_date|container_id|percent_calculated|temperature|battery_status|    measured_at_utc|pick_at_utc|percent_before|percent_now|\n+----------+------------+------------------+-----------+--------------+-------------------+-----------+--------------+-----------+\n|2019-10-21|       30039|                90|         12|           3.6|2019-10-21 07:18:56|       null|          null|       null|\n|2019-10-21|       30039|                98|         12|           3.6|2019-10-21 04:18:56|       null|          null|       null|\n|2019-10-20|       30039|                92|         14|           3.6|2019-10-20 17:18:58|       null|          null|       null|\n|2019-10-20|       30039|                91|         14|           3.6|2019-10-20 15:18:59|       null|          null|       null|\n|2019-10-20|       30039|                69|         14|           3.6|2019-10-20 13:18:58|       null|          null|       null|\n+----------+------------+------------------+-----------+--------------+-------------------+-----------+--------------+-----------+\nonly showing top 5 rows\n\n+----------+---------------------+-----------------------------+\n|event_date|info_m               |info_p                       |\n+----------+---------------------+-----------------------------+\n|2019-10-01|namerena teplota 13°C|vysypano pri zaplnenosti 100%|\n|2019-10-01|namerena teplota 16°C|vysypano pri zaplnenosti 100%|\n|2019-10-01|namerena teplota 17°C|vysypano pri zaplnenosti 100%|\n|2019-10-01|namerena teplota 14°C|vysypano pri zaplnenosti 100%|\n|2019-10-01|namerena teplota 16°C|vysypano pri zaplnenosti 100%|\n|2019-10-01|namerena teplota 13°C|vysypano pri zaplnenosti 100%|\n|2019-10-04|namerena teplota 9°C |vysypano pri zaplnenosti 93% |\n|2019-10-04|namerena teplota 9°C |vysypano pri zaplnenosti 93% |\n|2019-10-04|namerena teplota 11°C|vysypano pri zaplnenosti 93% |\n|2019-10-04|namerena teplota 11°C|vysypano pri zaplnenosti 93% |\n|2019-10-04|namerena teplota 11°C|vysypano pri zaplnenosti 93% |\n|2019-10-04|namerena teplota 12°C|vysypano pri zaplnenosti 93% |\n|2019-10-08|namerena teplota 10°C|vysypano pri zaplnenosti 100%|\n|2019-10-08|namerena teplota 7°C |vysypano pri zaplnenosti 100%|\n|2019-10-08|namerena teplota 11°C|vysypano pri zaplnenosti 100%|\n|2019-10-08|namerena teplota 7°C |vysypano pri zaplnenosti 100%|\n|2019-10-08|namerena teplota 9°C |vysypano pri zaplnenosti 100%|\n|2019-10-08|namerena teplota 11°C|vysypano pri zaplnenosti 100%|\n|2019-10-11|namerena teplota 11°C|vysypano pri zaplnenosti 63% |\n|2019-10-11|namerena teplota 13°C|vysypano pri zaplnenosti 63% |\n+----------+---------------------+-----------------------------+\nonly showing top 20 rows\n\nnadoba30039: org.apache.spark.sql.DataFrame \u003d [event_date: string, container_id: int ... 7 more fields]\nimport org.apache.spark.sql.functions.udf\nmeasured: org.apache.spark.sql.expressions.UserDefinedFunction \u003d UserDefinedFunction(\u003cfunction2\u003e,StringType,Some(List(StringType, StringType)))\npicked: org.apache.spark.sql.expressions.UserDefinedFunction \u003d UserDefinedFunction(\u003cfunction2\u003e,StringType,Some(List(StringType, StringType)))\nbothEvents: org.apache.spark.sql.expressions.UserDefinedFunction \u003d UserDefinedFunction(\u003cfunction2\u003e,BooleanType,Some(List(StringType, StringType)))\nnadoba30039_2: org.apache.spark.sql.DataFrame \u003d [event_date: string, container_id: int ... 10 more fields]\nnadoba30039_3: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] \u003d [event_date: string, info_m: string ......"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1572275721525_-1435476127",
      "id": "20191028-135404_319133906",
      "dateCreated": "2019-10-28 15:15:21.525",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "spark-simple-zadani",
  "id": "2ERFC2GHX",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {
    "md:shared_process": [],
    "spark:shared_process": []
  },
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {}
}