{
  "paragraphs": [
    {
      "text": "%md\n## Apache Spark - základní syntax a práce s daty\n\n* datové zdroje: http://opendata.praha.eu/\n   * chytry svoz odpadu - historie zaplnitelnosti: http://opendata.praha.eu/dataset/chytry-svoz-odpadu-historicka-data-zaplnenosti\n   * chytry svoz odpadu  - svozy kontejnerů na tříděný odpad: http://opendata.praha.eu/dataset/chytry-svoz-odpadu-svozy-kontejneru-na-trideny-odpad\n   * \n   \n## hodí se\n* `df.printSchema()` - vypíše názvy a typy sloupců\n* `df.show(X)`- zobrazí X počet řádků z datasetu, nezáleží na pořadí, nevyvolává action trigger \n* Scala guide: https://www.analyticsvidhya.com/blog/2017/01/scala/",
      "user": "anonymous",
      "dateUpdated": "2019-10-28 11:28:13.440",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": false,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eApache Spark - základní syntax a práce s daty\u003c/h2\u003e\n\u003cul\u003e\n  \u003cli\u003edatové zdroje: \u003ca href\u003d\"http://opendata.praha.eu/\"\u003ehttp://opendata.praha.eu/\u003c/a\u003e\u003c/li\u003e\n  \u003cli\u003echytry svoz odpadu - historie zaplnitelnosti: \u003ca href\u003d\"http://opendata.praha.eu/dataset/chytry-svoz-odpadu-historicka-data-zaplnenosti\"\u003ehttp://opendata.praha.eu/dataset/chytry-svoz-odpadu-historicka-data-zaplnenosti\u003c/a\u003e\u003c/li\u003e\n  \u003cli\u003echytry svoz odpadu - svozy kontejnerů na tříděný odpad: \u003ca href\u003d\"http://opendata.praha.eu/dataset/chytry-svoz-odpadu-svozy-kontejneru-na-trideny-odpad\"\u003ehttp://opendata.praha.eu/dataset/chytry-svoz-odpadu-svozy-kontejneru-na-trideny-odpad\u003c/a\u003e\u003c/li\u003e\n  \u003cli\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003ehodí se\u003c/h2\u003e\n\u003cul\u003e\n  \u003cli\u003e\u003ccode\u003edf.printSchema()\u003c/code\u003e - vypíše názvy a typy sloupců\u003c/li\u003e\n  \u003cli\u003e\u003ccode\u003edf.show(X)\u003c/code\u003e- zobrazí X počet řádků z datasetu, nezáleží na pořadí, nevyvolává action trigger\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1572255444776_1730217125",
      "id": "20191028-093724_2122815264",
      "dateCreated": "2019-10-28 09:37:24.776",
      "dateStarted": "2019-10-28 10:34:59.858",
      "dateFinished": "2019-10-28 10:35:01.757",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// načtení csv souboru\nval szn2019q4 \u003d spark.read.format(\"csv\")\n  .option(\"sep\", \";\")\n  .option(\"inferSchema\", \"true\")\n  .option(\"header\", \"true\")\n  .load(\"detekce-svozu-nadob-2019-q4.csv\")",
      "user": "anonymous",
      "dateUpdated": "2019-10-28 10:52:23.971",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "tableHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "szn2019q4: org.apache.spark.sql.DataFrame \u003d [id: int, container_id: int ... 7 more fields]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://62067575309b:4040/jobs/job?id\u003d0",
            "http://62067575309b:4040/jobs/job?id\u003d1"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1572253272232_-1665768480",
      "id": "20191028-090112_1378723200",
      "dateCreated": "2019-10-28 09:01:12.233",
      "dateStarted": "2019-10-28 10:35:01.881",
      "dateFinished": "2019-10-28 10:35:07.940",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// vypis schematu\nszn2019q4.printSchema()\nszn2019q4.show(10)",
      "user": "anonymous",
      "dateUpdated": "2019-10-28 10:35:08.018",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "tableHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- id: integer (nullable \u003d true)\n |-- container_id: integer (nullable \u003d true)\n |-- pick_minfilllevel: integer (nullable \u003d true)\n |-- decrease: integer (nullable \u003d true)\n |-- code: string (nullable \u003d true)\n |-- pick_at_utc: timestamp (nullable \u003d true)\n |-- percent_before: integer (nullable \u003d true)\n |-- percent_now: integer (nullable \u003d true)\n |-- event_driven: boolean (nullable \u003d true)\n\n+--------+------------+-----------------+--------+---------------+-------------------+--------------+-----------+------------+\n|      id|container_id|pick_minfilllevel|decrease|           code|        pick_at_utc|percent_before|percent_now|event_driven|\n+--------+------------+-----------------+--------+---------------+-------------------+--------------+-----------+------------+\n|15270292|       30046|               50|      20|0003/ 014C00513|2019-10-01 05:00:41|           100|          1|       false|\n|15270477|       30327|               30|      20|0001/ 002C01582|2019-10-01 05:01:47|            38|          1|       false|\n|15270800|       30064|               30|      20|0003/ 035C00551|2019-10-01 05:12:45|            44|         16|       false|\n|15270879|       30116|               30|      20|0003/ 084C00644|2019-10-01 05:12:49|           100|         10|       false|\n|15271061|       29927|               30|      20|0006/ 262C00242|2019-10-01 05:19:44|           100|          0|       false|\n|15271066|       30034|               30|      20|0003/ 012C00493|2019-10-01 05:20:36|           100|          0|       false|\n|15271124|       30060|               50|      20|0003/ 030C00542|2019-10-01 05:25:38|           100|          7|       false|\n|15271202|       30040|               30|      20|0003/ 013C00502|2019-10-01 05:39:07|           100|         10|       false|\n|15271205|       30109|               30|      20|0003/ 076C00634|2019-10-01 05:39:08|            89|          4|       false|\n|15271776|       30071|               30|      20|0003/ 036C00563|2019-10-01 06:01:40|            97|          3|       false|\n+--------+------------+-----------------+--------+---------------+-------------------+--------------+-----------+------------+\nonly showing top 10 rows\n\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://62067575309b:4040/jobs/job?id\u003d2"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1572256004324_2137656663",
      "id": "20191028-094644_234913939",
      "dateCreated": "2019-10-28 09:46:44.324",
      "dateStarted": "2019-10-28 10:35:08.108",
      "dateFinished": "2019-10-28 10:35:08.917",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// akce, udela trigger jobu\n// TODO podivat se co to udelalo v historii\nszn2019q4.take(2)",
      "user": "anonymous",
      "dateUpdated": "2019-10-28 10:35:09.008",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "tableHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "res4: Array[org.apache.spark.sql.Row] \u003d Array([15270292,30046,50,20,0003/ 014C00513,2019-10-01 05:00:41.0,100,1,false], [15270477,30327,30,20,0001/ 002C01582,2019-10-01 05:01:47.0,38,1,false])\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://62067575309b:4040/jobs/job?id\u003d3"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1572256031656_-1169692538",
      "id": "20191028-094711_2111991067",
      "dateCreated": "2019-10-28 09:47:11.656",
      "dateStarted": "2019-10-28 10:35:09.119",
      "dateFinished": "2019-10-28 10:35:09.548",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## NARROW transformace\n* map\n* filter\n* flatmap\n* union\n* ...",
      "user": "anonymous",
      "dateUpdated": "2019-10-28 11:17:38.411",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1572261393476_-282160138",
      "id": "20191028-111633_1032845225",
      "dateCreated": "2019-10-28 11:16:33.476",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// nacteme dalsi data a protoze vime,ze jsou stejna, muzeme spojit do jednoho DataSetu\nval szn2018122019Q3 \u003d spark.read.format(\"csv\")\n  .option(\"sep\", \";\")\n  .option(\"inferSchema\", \"true\")\n  .option(\"header\", \"true\")\n  .load(\"detekce-svozu-nadob-201812-2019Q3.csv\")\n  \nszn2018122019Q3.show(3)",
      "user": "anonymous",
      "dateUpdated": "2019-10-28 10:53:50.169",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+------------+-----------------+--------+---------------+-------------------+--------------+-----------+------------+\n|     id|container_id|pick_minfilllevel|decrease|           code|        pick_at_utc|percent_before|percent_now|event_driven|\n+-------+------------+-----------------+--------+---------------+-------------------+--------------+-----------+------------+\n|5252000|       29806|               30|      20|0018/ 050C00471|2018-12-01 05:06:27|            76|          6|       false|\n|5278394|       29808|               30|      20|0018/ 050C00473|2018-12-03 09:08:48|            95|          2|       false|\n|5280954|       29789|               30|      20|0006/ 264C00204|2018-12-03 13:09:24|            89|         13|       false|\n+-------+------------+-----------------+--------+---------------+-------------------+--------------+-----------+------------+\nonly showing top 3 rows\n\nszn2018122019Q3: org.apache.spark.sql.DataFrame \u003d [id: int, container_id: int ... 7 more fields]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://62067575309b:4040/jobs/job?id\u003d4",
            "http://62067575309b:4040/jobs/job?id\u003d5",
            "http://62067575309b:4040/jobs/job?id\u003d6"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1572256472727_1936850616",
      "id": "20191028-095432_287439436",
      "dateCreated": "2019-10-28 09:54:32.728",
      "dateStarted": "2019-10-28 10:35:09.684",
      "dateFinished": "2019-10-28 10:35:11.028",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// UNION\nval szn \u003d szn2019q4.union(szn2018122019Q3)",
      "user": "anonymous",
      "dateUpdated": "2019-10-28 10:35:11.087",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "ERROR",
        "msg": [
          {
            "type": "TEXT",
            "data": "org.apache.spark.sql.AnalysisException: Union can only be performed on tables with the compatible column types. string \u003c\u003e boolean at the 8th column of the second table;;\n\u0027Union\n:- Relation[id#10,container_id#11,pick_minfilllevel#12,decrease#13,code#14,pick_at_utc#15,percent_before#16,percent_now#17,event_driven#18] csv\n+- Relation[id#87,container_id#88,pick_minfilllevel#89,decrease#90,code#91,pick_at_utc#92,percent_before#93,percent_now#94,event_driven#95] csv\n\n  at org.apache.spark.sql.catalyst.analysis.CheckAnalysis$class.failAnalysis(CheckAnalysis.scala:42)\n  at org.apache.spark.sql.catalyst.analysis.Analyzer.failAnalysis(Analyzer.scala:92)\n  at org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1$$anonfun$apply$11$$anonfun$apply$12.apply(CheckAnalysis.scala:261)\n  at org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1$$anonfun$apply$11$$anonfun$apply$12.apply(CheckAnalysis.scala:258)\n  at scala.collection.immutable.List.foreach(List.scala:381)\n  at org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1$$anonfun$apply$11.apply(CheckAnalysis.scala:258)\n  at org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1$$anonfun$apply$11.apply(CheckAnalysis.scala:247)\n  at scala.collection.immutable.List.foreach(List.scala:381)\n  at org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.apply(CheckAnalysis.scala:247)\n  at org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.apply(CheckAnalysis.scala:85)\n  at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:127)\n  at org.apache.spark.sql.catalyst.analysis.CheckAnalysis$class.checkAnalysis(CheckAnalysis.scala:85)\n  at org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:92)\n  at org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:105)\n  at org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:57)\n  at org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:55)\n  at org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:47)\n  at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:74)\n  at org.apache.spark.sql.Dataset.withSetOperator(Dataset.scala:3319)\n  at org.apache.spark.sql.Dataset.union(Dataset.scala:1840)\n  ... 47 elided\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1572256802527_-1127095320",
      "id": "20191028-100002_1173038509",
      "dateCreated": "2019-10-28 10:00:02.528",
      "dateStarted": "2019-10-28 10:35:11.187",
      "dateFinished": "2019-10-28 10:35:11.564",
      "status": "ERROR",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// co s tim? ヽ(`o´)ﾉ, musime pretypovat...\n\nszn2019q4.printSchema()\nszn2018122019Q3.printSchema()",
      "user": "anonymous",
      "dateUpdated": "2019-10-28 10:13:40.529",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- id: integer (nullable \u003d true)\n |-- container_id: integer (nullable \u003d true)\n |-- pick_minfilllevel: integer (nullable \u003d true)\n |-- decrease: integer (nullable \u003d true)\n |-- code: string (nullable \u003d true)\n |-- pick_at_utc: timestamp (nullable \u003d true)\n |-- percent_before: integer (nullable \u003d true)\n |-- percent_now: integer (nullable \u003d true)\n |-- event_driven: boolean (nullable \u003d true)\n\nroot\n |-- id: integer (nullable \u003d true)\n |-- container_id: integer (nullable \u003d true)\n |-- pick_minfilllevel: integer (nullable \u003d true)\n |-- decrease: integer (nullable \u003d true)\n |-- code: string (nullable \u003d true)\n |-- pick_at_utc: timestamp (nullable \u003d true)\n |-- percent_before: integer (nullable \u003d true)\n |-- percent_now: integer (nullable \u003d true)\n |-- event_driven: string (nullable \u003d true)\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1572256897573_967693521",
      "id": "20191028-100137_1794046050",
      "dateCreated": "2019-10-28 10:01:37.574",
      "dateStarted": "2019-10-28 10:02:08.437",
      "dateFinished": "2019-10-28 10:02:08.702",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// cast je transformace typu MAP: 1 zaznam -\u003e 1 zaznam transformovany\nimport org.apache.spark.sql.types.BooleanType\n\nval szn2018122019Q3_2 \u003d szn2018122019Q3.withColumn(\"event_driven_tmp\", szn2018122019Q3(\"event_driven\").cast(BooleanType))\n// jenze to stale jeste tak uplne nestaci, dataframes stejne jako RDD jsou immutable kolekce, tj. withColumn nam pouze vytvorilo novou kolekci se sloupcem navic\nszn2018122019Q3_2.printSchema()\nszn2018122019Q3_2.show(2)\n// musime explicitne rict,ze se ma sloupec smazat a nahradit nasim novym\nval szn2018122019Q3_3 \u003d szn2018122019Q3_2.drop(\"event_driven\").withColumnRenamed(\"event_driven_tmp\", \"event_driven\")\nszn2018122019Q3_3.printSchema()\nszn2018122019Q3_3.show(2)\n\n// protoze je toto v podstate 1 map transformace slozena ze tri,lze zapsat i v jenom kroku\nval szn2018122019Q3_4 \u003d szn2018122019Q3.withColumn(\"event_driven_tmp\", szn2018122019Q3(\"event_driven\").cast(BooleanType)).drop(\"event_driven\").withColumnRenamed(\"event_driven_tmp\", \"event_driven\")\nszn2018122019Q3_4.printSchema()\nszn2018122019Q3_4.show(2)",
      "user": "anonymous",
      "dateUpdated": "2019-10-28 11:18:45.738",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- id: integer (nullable \u003d true)\n |-- container_id: integer (nullable \u003d true)\n |-- pick_minfilllevel: integer (nullable \u003d true)\n |-- decrease: integer (nullable \u003d true)\n |-- code: string (nullable \u003d true)\n |-- pick_at_utc: timestamp (nullable \u003d true)\n |-- percent_before: integer (nullable \u003d true)\n |-- percent_now: integer (nullable \u003d true)\n |-- event_driven: string (nullable \u003d true)\n |-- event_driven_tmp: boolean (nullable \u003d true)\n\n+-------+------------+-----------------+--------+---------------+-------------------+--------------+-----------+------------+----------------+\n|     id|container_id|pick_minfilllevel|decrease|           code|        pick_at_utc|percent_before|percent_now|event_driven|event_driven_tmp|\n+-------+------------+-----------------+--------+---------------+-------------------+--------------+-----------+------------+----------------+\n|5252000|       29806|               30|      20|0018/ 050C00471|2018-12-01 05:06:27|            76|          6|       false|           false|\n|5278394|       29808|               30|      20|0018/ 050C00473|2018-12-03 09:08:48|            95|          2|       false|           false|\n+-------+------------+-----------------+--------+---------------+-------------------+--------------+-----------+------------+----------------+\nonly showing top 2 rows\n\nroot\n |-- id: integer (nullable \u003d true)\n |-- container_id: integer (nullable \u003d true)\n |-- pick_minfilllevel: integer (nullable \u003d true)\n |-- decrease: integer (nullable \u003d true)\n |-- code: string (nullable \u003d true)\n |-- pick_at_utc: timestamp (nullable \u003d true)\n |-- percent_before: integer (nullable \u003d true)\n |-- percent_now: integer (nullable \u003d true)\n |-- event_driven: boolean (nullable \u003d true)\n\n+-------+------------+-----------------+--------+---------------+-------------------+--------------+-----------+------------+\n|     id|container_id|pick_minfilllevel|decrease|           code|        pick_at_utc|percent_before|percent_now|event_driven|\n+-------+------------+-----------------+--------+---------------+-------------------+--------------+-----------+------------+\n|5252000|       29806|               30|      20|0018/ 050C00471|2018-12-01 05:06:27|            76|          6|       false|\n|5278394|       29808|               30|      20|0018/ 050C00473|2018-12-03 09:08:48|            95|          2|       false|\n+-------+------------+-----------------+--------+---------------+-------------------+--------------+-----------+------------+\nonly showing top 2 rows\n\n+-------+------------+-----------------+--------+---------------+-------------------+--------------+-----------+------------+\n|     id|container_id|pick_minfilllevel|decrease|           code|        pick_at_utc|percent_before|percent_now|event_driven|\n+-------+------------+-----------------+--------+---------------+-------------------+--------------+-----------+------------+\n|5252000|       29806|               30|      20|0018/ 050C00471|2018-12-01 05:06:27|            76|          6|       false|\n|5278394|       29808|               30|      20|0018/ 050C00473|2018-12-03 09:08:48|            95|          2|       false|\n+-------+------------+-----------------+--------+---------------+-------------------+--------------+-----------+------------+\nonly showing top 2 rows\n\nimport org.apache.spark.sql.types.BooleanType\nszn2018122019Q3_2: org.apache.spark.sql.DataFrame \u003d [id: int, container_id: int ... 8 more fields]\nszn2018122019Q3_3: org.apache.spark.sql.DataFrame \u003d [id: int, container_id: int ... 7 more fields]\nszn2018122019Q3_4: org.apache.spark.sql.DataFrame \u003d [id: int, container_id: int ... 7 more fields]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://62067575309b:4040/jobs/job?id\u003d12",
            "http://62067575309b:4040/jobs/job?id\u003d13",
            "http://62067575309b:4040/jobs/job?id\u003d14"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1572256941207_1629444319",
      "id": "20191028-100221_916573721",
      "dateCreated": "2019-10-28 10:02:21.208",
      "dateStarted": "2019-10-28 10:43:36.380",
      "dateFinished": "2019-10-28 10:43:37.111",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// muzem nyni spojit 2 dataframe, vznika nam struktura DataSet s totoznyma operacema akorat ze zastresuje 2 dataframy\nval szn \u003d szn2019q4.union(szn2018122019Q3_3)\nszn.show(2)",
      "user": "anonymous",
      "dateUpdated": "2019-10-28 11:19:37.701",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+------------+-----------------+--------+---------------+-------------------+--------------+-----------+------------+\n|      id|container_id|pick_minfilllevel|decrease|           code|        pick_at_utc|percent_before|percent_now|event_driven|\n+--------+------------+-----------------+--------+---------------+-------------------+--------------+-----------+------------+\n|15270292|       30046|               50|      20|0003/ 014C00513|2019-10-01 05:00:41|           100|          1|       false|\n|15270477|       30327|               30|      20|0001/ 002C01582|2019-10-01 05:01:47|            38|          1|       false|\n+--------+------------+-----------------+--------+---------------+-------------------+--------------+-----------+------------+\nonly showing top 2 rows\n\nszn: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] \u003d [id: int, container_id: int ... 7 more fields]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://62067575309b:4040/jobs/job?id\u003d11"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1572259302765_203490331",
      "id": "20191028-104142_118906941",
      "dateCreated": "2019-10-28 10:41:42.765",
      "dateStarted": "2019-10-28 10:42:16.497",
      "dateFinished": "2019-10-28 10:42:17.006",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## AKCE\n* take, count, collect, top",
      "user": "anonymous",
      "dateUpdated": "2019-10-28 11:23:35.796",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1572261592448_-108368267",
      "id": "20191028-111952_432182074",
      "dateCreated": "2019-10-28 11:19:52.448",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// N zaznamu -\u003e podmmnozina\nszn.take(2)\n\n// N zaznamu -\u003e N zaznamu\nszn.collect()",
      "user": "anonymous",
      "dateUpdated": "2019-10-28 11:29:07.753",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "res40: Array[org.apache.spark.sql.Row] \u003d Array([15270292,30046,50,20,0003/ 014C00513,2019-10-01 05:00:41.0,100,1,false], [15270477,30327,30,20,0001/ 002C01582,2019-10-01 05:01:47.0,38,1,false])\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://62067575309b:4040/jobs/job?id\u003d117"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1572261610375_80891810",
      "id": "20191028-112010_1454345083",
      "dateCreated": "2019-10-28 11:20:10.375",
      "dateStarted": "2019-10-28 11:20:50.551",
      "dateFinished": "2019-10-28 11:20:50.791",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// COUNT\n// kolik mam zaznamu?\nval szn2019q4_count \u003d szn2019q4.count()\nval szn20182019q3_count \u003d szn2018122019Q3_3.count()\nval szn_count \u003d szn.count().longValue()\n\nprint(\"Počet záznamů:2019q4: \" + szn2019q4_count + \", 2018-2019q3: \" + szn20182019q3_count + \", dohromady tedy: \" +  szn_count)",
      "user": "anonymous",
      "dateUpdated": "2019-10-28 11:23:11.170",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "szn2019q4_count: Long \u003d 1002\nszn20182019q3_count: Long \u003d 22987\nszn_count: Long \u003d 23989\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://62067575309b:4040/jobs/job?id\u003d33",
            "http://62067575309b:4040/jobs/job?id\u003d34",
            "http://62067575309b:4040/jobs/job?id\u003d35"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1572259199571_-373008067",
      "id": "20191028-103959_1146384647",
      "dateCreated": "2019-10-28 10:39:59.571",
      "dateStarted": "2019-10-28 10:56:57.825",
      "dateFinished": "2019-10-28 10:56:58.521",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// získávání informací o datasetu\nszn.show(4)\n\n// kolik unikátních odpadových konetjnerů máme\nval container_id\u003dszn.select(\"container_id\").distinct()\nval container_id_count \u003d container_id.count()\ncontainer_id.show(3)\n\n// dalsi info\nval szn_ids\u003dszn.select(\"id\").distinct()\nval ids_count \u003d szn_ids.count()\nszn_ids.show(3)\n\nval pick_minfilllevel\u003dszn.select(\"pick_minfilllevel\").distinct()\npick_minfilllevel.show(4)\n\nval kod\u003dszn.select(\"code\").distinct()\nval kod_count \u003d kod.count()\nkod.show(10)\n\nval eventDriven\u003dszn.select(\"event_driven\").distinct()\nval eventDrivenCount \u003d eventDriven.count()\neventDriven.show(2)\n",
      "user": "anonymous",
      "dateUpdated": "2019-10-28 11:29:16.219",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+------------+-----------------+--------+---------------+-------------------+--------------+-----------+------------+\n|      id|container_id|pick_minfilllevel|decrease|           code|        pick_at_utc|percent_before|percent_now|event_driven|\n+--------+------------+-----------------+--------+---------------+-------------------+--------------+-----------+------------+\n|15270292|       30046|               50|      20|0003/ 014C00513|2019-10-01 05:00:41|           100|          1|       false|\n|15270477|       30327|               30|      20|0001/ 002C01582|2019-10-01 05:01:47|            38|          1|       false|\n|15270800|       30064|               30|      20|0003/ 035C00551|2019-10-01 05:12:45|            44|         16|       false|\n|15270879|       30116|               30|      20|0003/ 084C00644|2019-10-01 05:12:49|           100|         10|       false|\n+--------+------------+-----------------+--------+---------------+-------------------+--------------+-----------+------------+\nonly showing top 4 rows\n\n+------------+\n|container_id|\n+------------+\n|       29993|\n|       29894|\n|       29834|\n+------------+\nonly showing top 3 rows\n\n+--------+\n|      id|\n+--------+\n|15315806|\n|15328950|\n|15342350|\n+--------+\nonly showing top 3 rows\n\n+-----------------+\n|pick_minfilllevel|\n+-----------------+\n|               40|\n|               35|\n|               50|\n|               30|\n+-----------------+\n\n+---------------+\n|           code|\n+---------------+\n|0006/ 263C00234|\n|0003/ 024C00532|\n|0001/ 016C01532|\n|0001/ 038C00043|\n|0008/ 034C01384|\n|0010/ 265C00453|\n|0016/ 038C01422|\n|0001/ 035C01593|\n|0006/ 260C00165|\n|0009/ 157C00354|\n+---------------+\nonly showing top 10 rows\n\n+------------+\n|event_driven|\n+------------+\n|        null|\n|       false|\n+------------+\n\ncontainer_id: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] \u003d [container_id: int]\ncontainer_id_count: Long \u003d 420\nszn_ids: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] \u003d [id: int]\nids_count: Long \u003d 13847\npick_minfilllevel: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] \u003d [pick_minfilllevel: int]\nkod: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] \u003d [code: string]\nkod_count: Long \u003d 429\neventDriven: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] \u003d [event_driven: boolean]\neventDrivenCount: Long \u003d 2\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://62067575309b:4040/jobs/job?id\u003d118",
            "http://62067575309b:4040/jobs/job?id\u003d119",
            "http://62067575309b:4040/jobs/job?id\u003d120",
            "http://62067575309b:4040/jobs/job?id\u003d121",
            "http://62067575309b:4040/jobs/job?id\u003d122",
            "http://62067575309b:4040/jobs/job?id\u003d123",
            "http://62067575309b:4040/jobs/job?id\u003d124",
            "http://62067575309b:4040/jobs/job?id\u003d125",
            "http://62067575309b:4040/jobs/job?id\u003d126",
            "http://62067575309b:4040/jobs/job?id\u003d127",
            "http://62067575309b:4040/jobs/job?id\u003d128",
            "http://62067575309b:4040/jobs/job?id\u003d129",
            "http://62067575309b:4040/jobs/job?id\u003d130",
            "http://62067575309b:4040/jobs/job?id\u003d131",
            "http://62067575309b:4040/jobs/job?id\u003d132",
            "http://62067575309b:4040/jobs/job?id\u003d133",
            "http://62067575309b:4040/jobs/job?id\u003d134",
            "http://62067575309b:4040/jobs/job?id\u003d135",
            "http://62067575309b:4040/jobs/job?id\u003d136",
            "http://62067575309b:4040/jobs/job?id\u003d137",
            "http://62067575309b:4040/jobs/job?id\u003d138"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1572260215376_-115532283",
      "id": "20191028-105655_287503105",
      "dateCreated": "2019-10-28 10:56:55.376",
      "dateStarted": "2019-10-28 11:29:16.268",
      "dateFinished": "2019-10-28 11:29:24.378",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// jaky je vztah id (pocet 13847 ) a container_id (mame 420), zaznamu celkem 23989\nval df\u003dszn.select(\"id\",\"container_id\").distinct().sort(\"id\")\nval count \u003d df.count()\ndf.show(40)",
      "user": "anonymous",
      "dateUpdated": "2019-10-28 11:15:03.247",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+------------+\n|      id|container_id|\n+--------+------------+\n| 5252000|       29806|\n| 5278394|       29808|\n| 5280954|       29789|\n| 5302784|       29805|\n| 5302791|       29804|\n| 5302796|       29821|\n| 5302799|       29803|\n| 5302949|       29786|\n| 5302995|       29830|\n| 5304367|       29820|\n| 5305500|       29793|\n| 5317716|       29801|\n| 5327215|       29789|\n| 5327233|       29826|\n| 5332528|       29788|\n|10021952|       29808|\n|10021958|       29824|\n|10021960|       29831|\n|10023477|       29800|\n|10023552|       29788|\n|10024597|       29789|\n|10024600|       29827|\n|10024602|       29829|\n|10024617|       29821|\n|10024635|       29809|\n|10027334|       29798|\n|10044278|       29795|\n|10046264|       29822|\n|10046267|       29823|\n|10047565|       29796|\n|10047960|       29792|\n|10049043|       29793|\n|10056382|       29806|\n|10056660|       30053|\n|10056680|       30039|\n|10056730|       29907|\n|10056746|       30067|\n|10058670|       30068|\n|10058712|       29918|\n|10058720|       29934|\n+--------+------------+\nonly showing top 40 rows\n\ndf: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] \u003d [id: int, container_id: int]\ncount: Long \u003d 13847\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://62067575309b:4040/jobs/job?id\u003d70",
            "http://62067575309b:4040/jobs/job?id\u003d71",
            "http://62067575309b:4040/jobs/job?id\u003d72"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1572260805656_217973668",
      "id": "20191028-110645_1932819943",
      "dateCreated": "2019-10-28 11:06:45.656",
      "dateStarted": "2019-10-28 11:11:37.020",
      "dateFinished": "2019-10-28 11:11:45.248",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// select, filter, map, flatmap",
      "user": "anonymous",
      "dateUpdated": "2019-10-28 09:50:23.943",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1572256203074_-1186104881",
      "id": "20191028-095003_1349749597",
      "dateCreated": "2019-10-28 09:50:03.074",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// reduce by key, union",
      "user": "anonymous",
      "dateUpdated": "2019-10-28 09:51:17.969",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1572256251124_-754797474",
      "id": "20191028-095051_1134593994",
      "dateCreated": "2019-10-28 09:50:51.124",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## K procvičení (když zbude čas)\n### Formáty\n* parquet\n  * defaultní pro Spark\n  * binární formát\n  * column oriented\n  * hodí se pro projekce (potřebuji z velkých dat, pouze některé sloupčeky)\n* avro\n* csv,tsv\n* json\n   * výhody:\n     * lehce se čte i ostatním mimo Big Data svět (webaři, data science)\n  * pozor: validní json je co file to {}, pro big data se ovšeh hodí pouze validní json per file (správně je ten formát názvem GSON) ",
      "user": "anonymous",
      "dateUpdated": "2019-10-28 09:44:32.729",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": false,
        "tableHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eK procvičení (když zbude čas)\u003c/h2\u003e\n\u003ch3\u003eFormáty\u003c/h3\u003e\n\u003cul\u003e\n  \u003cli\u003eparquet\u003c/li\u003e\n  \u003cli\u003edefaultní pro Spark\u003c/li\u003e\n  \u003cli\u003ebinární formát\u003c/li\u003e\n  \u003cli\u003ecolumn oriented\u003c/li\u003e\n  \u003cli\u003ehodí se pro projekce (potřebuji z velkých dat, pouze některé sloupčeky)\u003c/li\u003e\n  \u003cli\u003eavro\u003c/li\u003e\n  \u003cli\u003ecsv,tsv\u003c/li\u003e\n  \u003cli\u003ejson\u003c/li\u003e\n  \u003cli\u003evýhody:\n    \u003cul\u003e\n      \u003cli\u003elehce se čte i ostatním mimo Big Data svět (webaři, data science)\u003c/li\u003e\n    \u003c/ul\u003e\n  \u003c/li\u003e\n  \u003cli\u003epozor: validní json je co file to {}, pro big data se ovšeh hodí pouze validní json per file (správně je ten formát názvem GSON)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1572253285426_-1226990686",
      "id": "20191028-090125_948111294",
      "dateCreated": "2019-10-28 09:01:25.426",
      "dateStarted": "2019-10-28 09:44:17.757",
      "dateFinished": "2019-10-28 09:44:17.808",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "read avro, read , json - show",
      "user": "anonymous",
      "dateUpdated": "2019-10-28 09:44:39.519",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1572255601414_941758733",
      "id": "20191028-094001_257022356",
      "dateCreated": "2019-10-28 09:40:01.414",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "spark-simple",
  "id": "2ER33N1G1",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {
    "md:shared_process": [],
    "spark:shared_process": []
  },
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {}
}